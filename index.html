<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hazelnut Profit Share</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
    <script>
        // Load TON Connect SDK dynamically with fallbacks
        (function() {
            const sdkUrls = [
                'https://unpkg.com/@tonconnect/sdk@2.2.0/dist/tonconnect-sdk.min.js',
                'https://cdn.jsdelivr.net/npm/@tonconnect/sdk@2.2.0/dist/tonconnect-sdk.min.js',
                'https://unpkg.com/@tonconnect/sdk@latest/dist/tonconnect-sdk.min.js'
            ];
            
            let currentUrlIndex = 0;
            
            function loadSDK() {
                if (currentUrlIndex >= sdkUrls.length) {
                    console.error('All TON Connect SDK CDN URLs failed');
                    window.tonConnectSDKLoaded = false;
                    return;
                }
                
                const script = document.createElement('script');
                script.src = sdkUrls[currentUrlIndex];
                script.async = true;
                script.crossOrigin = 'anonymous';
                
                script.onload = function() {
                    console.log('TON Connect SDK loaded from:', sdkUrls[currentUrlIndex]);
                    // Check if SDK is actually available
                    setTimeout(() => {
                        if (window.TonConnect) {
                            window.tonConnectSDKLoaded = true;
                            console.log('TON Connect SDK is available');
                        } else {
                            console.warn('Script loaded but TonConnect not available, trying next URL');
                            currentUrlIndex++;
                            loadSDK();
                        }
                    }, 100);
                };
                
                script.onerror = function() {
                    console.error('Failed to load SDK from:', sdkUrls[currentUrlIndex]);
                    currentUrlIndex++;
                    loadSDK();
                };
                
                document.head.appendChild(script);
            }
            
            // Start loading
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', loadSDK);
            } else {
                loadSDK();
            }
        })();
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸŒ° Hazelnut Profit Share</h1>
            <div class="user-info" id="userInfo">
                <span id="username">Loading...</span>
            </div>
        </header>

        <div class="wallet-status" id="walletStatus">
            <div class="status-indicator" id="statusIndicator"></div>
            <span id="walletText">Connecting to wallet...</span>
            <div id="tonconnect-button-container"></div>
            <button id="connectWallet" class="btn btn-primary" style="display: none;">Connect Wallet</button>
            <div id="walletAddress" style="display: none; font-size: 12px; color: #666; margin-top: 5px;"></div>
        </div>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="buy">Buy Token</button>
            <button class="tab-btn" data-tab="portfolio">Portfolio</button>
            <button class="tab-btn" data-tab="profit">Profit</button>
        </nav>

        <main>
            <!-- Buy Token Section -->
            <section id="buy" class="tab-content active">
                <div class="card">
                    <h2>Buy Hazelnut Token</h2>
                    <div class="token-info">
                        <p>Current Price: <span id="tokenPrice">$0.10</span></p>
                        <p>Available Supply: <span id="availableSupply">1,000,000 HZN</span></p>
                    </div>
                    <div class="input-group">
                        <label for="buyAmount">Amount (TON)</label>
                        <input type="number" id="buyAmount" placeholder="0.0" step="0.1" min="0.1">
                    </div>
                    <div class="input-group">
                        <label>You will receive:</label>
                        <div class="output" id="tokenAmount">0 HZN</div>
                    </div>
                    <button id="buyBtn" class="btn btn-primary btn-large">Buy Tokens</button>
                </div>
            </section>

            <!-- Portfolio Section -->
            <section id="portfolio" class="tab-content">
                <div class="card">
                    <h2>Your Portfolio</h2>
                    <div class="portfolio-stats">
                        <div class="stat-item">
                            <span class="stat-label">Total Tokens</span>
                            <span class="stat-value" id="totalTokens">0 HZN</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Total Value</span>
                            <span class="stat-value" id="totalValue">0 TON</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Average Price</span>
                            <span class="stat-value" id="avgPrice">-</span>
                        </div>
                    </div>
                    <div class="transaction-history">
                        <h3>Transaction History</h3>
                        <div id="transactionList" class="transaction-list">
                            <p class="empty-state">No transactions yet</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profit Section -->
            <section id="profit" class="tab-content">
                <div class="card">
                    <h2>Your Profit</h2>
                    <div class="profit-stats">
                        <div class="profit-item">
                            <span class="profit-label">Total Profit</span>
                            <span class="profit-value" id="totalProfit">0 TON</span>
                        </div>
                        <div class="profit-item">
                            <span class="profit-label">Profit Percentage</span>
                            <span class="profit-value" id="profitPercentage">0%</span>
                        </div>
                        <div class="profit-item">
                            <span class="profit-label">Last Distribution</span>
                            <span class="profit-value" id="lastDistribution">-</span>
                        </div>
                    </div>
                    <div class="profit-history">
                        <h3>Profit Distribution History</h3>
                        <div id="profitHistoryList" class="profit-list">
                            <p class="empty-state">No profit distributions yet</p>
                        </div>
                    </div>
                    <button id="claimProfitBtn" class="btn btn-success btn-large" style="display: none;">Claim Profit</button>
                </div>
            </section>
        </main>

        <footer class="app-footer">
            <div class="footer-content">
                <span>Version <span id="appVersion">-</span></span>
                <span class="footer-separator">â€¢</span>
                <span id="buildDate">-</span>
            </div>
        </footer>
    </div>

    <script src="version.js"></script>
    <script src="app.js"></script>
</body>
</html>







